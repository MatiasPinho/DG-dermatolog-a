---
import Layout from "../layouts/Layout.astro";
import {
 HeartHandshake,
 Syringe,
 SquareActivity,
 HandHeart,
 HeartPulse,
 Droplets,
 Video,
} from "@lucide/astro";
import ServiceCard from "../components/ServiceCard.astro";
---

<Layout>
 <section class="w-full flex flex-col items-center py-24 px-4 md:px-6">
  <div class="max-w-7xl mx-auto w-full">
   <div
    class="flex flex-col items-center gap-y-6 mb-12 md:mb-20 servicios-heading"
   >
    <h1
     class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-semibold text-center leading-[0.95] servicios-title"
     style="font-family: var(--font-sans);"
    >
     Planes de tratamiento <br />
     <em
      class="not-italic font-semibold text-primary"
      style="font-family: var(--font-serif); font-style: italic;"
     >Personalizados</em
     >
   </h1>
    <p class="text-lg servicios-description text-center">
     Cada plan es personalizado y nuestra atención incluye
    </p>
  </div>
   <section
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 servicios-grid mt-0"
   >
   <ServiceCard
     img="/service3.webp"
    title="Revisión médica completa"
     description={"Evaluación exhaustiva de la piel, pelo y uñas para detectar afecciones médicas y estéticas."}
   />
   <ServiceCard
     img="/service4.webp"
    title="Dermatoscopia digital"
     description={"Diagnóstico precoz de lesiones cutáneas mediante tecnología de imagen avanzada."}
   />
   <ServiceCard
     img="/service8.webp"
    title="Análisis de tipo de piel"
     description={"Identificación precisa del tipo de piel para rutinas personalizadas. Utilizando las mejores tecnologías"}
   />
   <ServiceCard
     img="/service2.webp"
    title="Limpiezas faciales y corporales"
     description={"Tratamientos profundos para eliminar impurezas y mejorar la salud de la piel."}
   />
   <ServiceCard
     img="/service7.webp"
    title="Tratamiento de acné"
     description={"Soluciones efectivas para el control del acné y la reducción de cicatrices."}
   />
   <ServiceCard
     img="/service6.webp"
    title="Rutina de cuidado de la piel"
     description={"Asesoramiento personalizado para crear rutinas de cuidado adaptadas a cada tipo de piel."}
   />
  </section>
  </div>
 </section>

 <script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);

  requestAnimationFrame(() => {
   const heading = document.querySelector(
    ".servicios-heading"
   ) as HTMLElement | null;
   const title = document.querySelector(
    ".servicios-title"
   ) as HTMLElement | null;
   const description = document.querySelector(
    ".servicios-description"
   ) as HTMLElement | null;
   const grid = document.querySelector(".servicios-grid") as HTMLElement | null;

   const cards = gsap.utils.toArray(".servicios-grid > *") as HTMLElement[];

   // Entrada del título
   if (heading && title) {
    gsap.set(title, {
     opacity: 0,
     y: 60,
     scale: 0.9,
     clipPath: "inset(0 0 100% 0)",
     transformOrigin: "center center",
     force3D: true,
    });

    gsap.to(title, {
     opacity: 1,
     y: 0,
     scale: 1,
     clipPath: "inset(0 0 0% 0)",
     duration: 1.2,
     ease: "expo.out",
     scrollTrigger: {
      trigger: heading,
      start: "top 80%",
      toggleActions: "play none none none",
     },
    });
   }

   // Entrada de la descripción
   if (heading && description) {
    gsap.set(description, {
     opacity: 0,
     y: 25,
     filter: "blur(10px)",
     force3D: true,
    });

    gsap.to(description, {
     opacity: 1,
     y: 0,
     filter: "blur(0px)",
     duration: 0.9,
     ease: "power2.out",
     scrollTrigger: {
      trigger: heading,
      start: "top 80%",
      toggleActions: "play none none none",
     },
    });
   }

   // Entrada de las cards con stagger
   if (grid && cards.length > 0) {
    gsap.set(cards, {
     opacity: 0,
     y: 60,
     scale: 0.96,
     transformOrigin: "center center",
     force3D: true,
    });

    gsap.to(cards, {
     opacity: 1,
     y: 0,
     scale: 1,
     duration: 1.0,
     ease: "power3.out",
     stagger: 0.12,
     scrollTrigger: {
      trigger: grid,
      start: "top 80%",
      toggleActions: "play none none none",
     },
    });
   }
  });
 </script>

 <style>
  /* Espacio entre heading y grid en desktop */
  @media (min-width: 768px) {
   .servicios-heading {
    margin-bottom: 5rem !important; /* 80px = mb-20 */
   }
  }

  /* Prevenir desborde horizontal y scroll doble en mobile - NO afecta desktop */
  @media (max-width: 768px) {
   /* Contenedor principal sin overflow que cause scroll doble */
   section:first-of-type {
    overflow-x: clip;
    overflow-y: visible;
    width: 100%;
    max-width: 100vw;
    position: relative;
   }

   /* Contenedor interno */
   section:first-of-type > div {
    width: 100%;
    max-width: 100%;
    overflow-x: clip;
   }

   .servicios-heading {
    width: 100%;
    max-width: 100%;
    overflow-x: clip;
   }

   .servicios-title {
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
    max-width: 100%;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
   }

   .servicios-description {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
   }

   .servicios-grid {
    width: 100%;
    max-width: 100%;
    overflow-x: clip;
    position: relative;
   }

   .servicios-grid > * {
    max-width: 100%;
    overflow-x: clip;
    position: relative;
   }
  }
 </style>
</Layout>
